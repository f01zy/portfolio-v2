import styles from "@/components/Post/Post.module.scss"
import { useTypedSelector } from "@/hooks/selector.hook";
import Link from "next/link";
import { useParams } from "next/navigation";
import ReactMarkdown from 'react-markdown'
import remarkGfm from 'remark-gfm'

const Post = () => {
  const params = useParams()
  const posts = useTypedSelector(state => state.postsSlice.entities)
  const post = posts.find(el => el._id == params.id)

  if (post === undefined) {
    return <div>Error. Post not found!</div>
  }

  return <div className={styles.post}>
    <h1>Blog</h1>
    <Link href={"/blog"}>
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M6.875 15.3L0.275 8.70001C0.175 8.60001 0.104 8.49167 0.0619998 8.37501C0.0206665 8.25834 0 8.13334 0 8.00001C0 7.86667 0.0206665 7.74167 0.0619998 7.62501C0.104 7.50834 0.175 7.40001 0.275 7.30001L6.875 0.700006C7.05833 0.516673 7.28733 0.420673 7.562 0.412006C7.83733 0.404006 8.075 0.500006 8.275 0.700006C8.475 0.883339 8.57933 1.11234 8.588 1.38701C8.596 1.66234 8.5 1.90001 8.3 2.10001L3.4 7.00001H14.575C14.8583 7.00001 15.096 7.09567 15.288 7.28701C15.4793 7.47901 15.575 7.71667 15.575 8.00001C15.575 8.28334 15.4793 8.52067 15.288 8.71201C15.096 8.90401 14.8583 9.00001 14.575 9.00001H3.4L8.3 13.9C8.48333 14.0833 8.57933 14.3167 8.588 14.6C8.596 14.8833 8.5 15.1167 8.3 15.3C8.11667 15.5 7.88333 15.6 7.6 15.6C7.31667 15.6 7.075 15.5 6.875 15.3Z" fill="white" />
      </svg>
      Back to home
    </Link>
    <div className={styles.post_detail}>
      <div className={styles.info}>
        <div>
          <div className={styles.views}>
            <div>
              <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_706_448" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="18">
                  <rect width="18" height="18" fill="#D9D9D9" />
                </mask>
                <g mask="url(#mask0_706_448)">
                  <path d="M3.75 16.5C3.3375 16.5 2.98425 16.3533 2.69025 16.0597C2.39675 15.7657 2.25 15.4125 2.25 15V4.5C2.25 4.0875 2.39675 3.7345 2.69025 3.441C2.98425 3.147 3.3375 3 3.75 3H4.5V2.23125C4.5 2.01875 4.57175 1.84375 4.71525 1.70625C4.85925 1.56875 5.0375 1.5 5.25 1.5C5.4625 1.5 5.64075 1.57175 5.78475 1.71525C5.92825 1.85925 6 2.0375 6 2.25V3H12V2.23125C12 2.01875 12.072 1.84375 12.216 1.70625C12.3595 1.56875 12.5375 1.5 12.75 1.5C12.9625 1.5 13.1405 1.57175 13.284 1.71525C13.428 1.85925 13.5 2.0375 13.5 2.25V3H14.25C14.6625 3 15.0157 3.147 15.3097 3.441C15.6033 3.7345 15.75 4.0875 15.75 4.5V15C15.75 15.4125 15.6033 15.7657 15.3097 16.0597C15.0157 16.3533 14.6625 16.5 14.25 16.5H3.75ZM3.75 15H14.25V7.5H3.75V15ZM3.75 6H14.25V4.5H3.75V6Z" fill="white" />
                </g>
              </svg>
              <p>{String(post.date)}</p>
            </div>
            <span>|</span>
            <div>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_804_796" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                  <rect width="24" height="24" fill="#D9D9D9" />
                </mask>
                <g mask="url(#mask0_804_796)">
                  <path d="M11.9998 16C13.2498 16 14.3125 15.5627 15.1878 14.688C16.0625 13.8127 16.4998 12.75 16.4998 11.5C16.4998 10.25 16.0625 9.18733 15.1878 8.312C14.3125 7.43733 13.2498 7 11.9998 7C10.7498 7 9.68714 7.43733 8.8118 8.312C7.93714 9.18733 7.4998 10.25 7.4998 11.5C7.4998 12.75 7.93714 13.8127 8.8118 14.688C9.68714 15.5627 10.7498 16 11.9998 16ZM11.9998 14.2C11.2498 14.2 10.6125 13.9373 10.0878 13.412C9.56247 12.8873 9.2998 12.25 9.2998 11.5C9.2998 10.75 9.56247 10.1123 10.0878 9.587C10.6125 9.06233 11.2498 8.8 11.9998 8.8C12.7498 8.8 13.3875 9.06233 13.9128 9.587C14.4375 10.1123 14.6998 10.75 14.6998 11.5C14.6998 12.25 14.4375 12.8873 13.9128 13.412C13.3875 13.9373 12.7498 14.2 11.9998 14.2ZM11.9998 19C9.68314 19 7.56647 18.3877 5.64981 17.163C3.73314 15.9377 2.28314 14.2833 1.2998 12.2C1.2498 12.1167 1.21647 12.0123 1.1998 11.887C1.18314 11.7623 1.1748 11.6333 1.1748 11.5C1.1748 11.3667 1.18314 11.2373 1.1998 11.112C1.21647 10.9873 1.2498 10.8833 1.2998 10.8C2.28314 8.71667 3.73314 7.06267 5.64981 5.838C7.56647 4.61267 9.68314 4 11.9998 4C14.3165 4 16.4331 4.61267 18.3498 5.838C20.2665 7.06267 21.7165 8.71667 22.6998 10.8C22.7498 10.8833 22.7831 10.9873 22.7998 11.112C22.8165 11.2373 22.8248 11.3667 22.8248 11.5C22.8248 11.6333 22.8165 11.7623 22.7998 11.887C22.7831 12.0123 22.7498 12.1167 22.6998 12.2C21.7165 14.2833 20.2665 15.9377 18.3498 17.163C16.4331 18.3877 14.3165 19 11.9998 19ZM11.9998 17C13.8831 17 15.6125 16.504 17.1878 15.512C18.7625 14.5207 19.9665 13.1833 20.7998 11.5C19.9665 9.81667 18.7625 8.479 17.1878 7.487C15.6125 6.49567 13.8831 6 11.9998 6C10.1165 6 8.38714 6.49567 6.8118 7.487C5.23714 8.479 4.03314 9.81667 3.1998 11.5C4.03314 13.1833 5.23714 14.5207 6.8118 15.512C8.38714 16.504 10.1165 17 11.9998 17Z" fill="white" />
                </g>
              </svg>
              <p>{post.views}</p>
            </div>
          </div>
          <h1>{post.title}</h1>
          <ul className={styles.tags}>
            {post.tags.map((el, index) => (
              <li key={index}># {el}</li>
            ))}
          </ul>
        </div>
      </div>
      <div className={styles.text}>
        <ReactMarkdown remarkPlugins={[remarkGfm]} className={styles.markdown}>
          {post.content}
        </ReactMarkdown>
      </div>
    </div>
  </div>
}

export default Post;